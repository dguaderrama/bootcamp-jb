
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7 ie" lang="en"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8 ie" lang="en"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9 ie" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	<title>Scripts</title>
	<meta name="author" content="Nathan Casler">
	
	<script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
  <script src='/bootcamp/assets/js/bootcamp.js'></script>  	
	<link href='/bootcamp/assets/themes/the-minimum/css/style.css' rel="stylesheet" media="all">
	<link href="http://feeds.feedburner.com/" rel="alternate" title="Scripts" type="application/atom+xml">
	<script src="http://cdnjs.cloudflare.com/ajax/libs/modernizr/2.0.6/modernizr.min.js"></script>
	
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">

	<!-- Latest compiled and minified JavaScript -->
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>

</head>
<body>

<div class="page-container">


<!-- post (.md) content -->
<div id="page" class="hentry">
	<header class="the-header">
		<div class="unit-head">
			<div class="unit-inner unit-head-inner">
				<p class="logo"><a href="/bootcamp/">Spatial Data Bootcamp</a></p>
				<nav class="nav-global">
					<ul>
            <li class="home"><a href="/bootcamp/index.html">Home</a></li>
            <li class="bootcamp"><a href="/bootcamp/intro/what">Bootcamp Material</a></li>
            <li class="about"><a href="/bootcamp/about.html">About Us</a></li>
					</ul>
				</nav>
			</div><!-- unit-inner -->
		</div><!-- unit-head -->
	</header>
	<div class="body" role="main">
		<div class="unit-body">
			<div class="unit-inner unit-body-inner">
				<div class="entry-content">
					
            <div class="dropdown-nav">
              <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Table of Contents<span class="caret"></span></a>
                <ul style="" class="dropdown-menu" role="menu">
                 
                  <h4 id="Setup-ref">Setup</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Setup/qgis-install">Installing QGIS</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Intro-ref">Intro</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Intro/what">Is Spatial Special?</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Intro/intro">Vectors and Rasters</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Intro/projections">Projections</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Data Collection-ref">Data collection</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/metadata">Metadata</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/consumable-services">Consumable Services</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/credible-sources">Credible Data Sources</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Data Wrangling-ref">Data wrangling</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Data Wrangling/functions">Spatial Manipulation</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Data wrangling-ref">Data wrangling</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Data wrangling/data-wrangling">Data Formatting</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Data Analysis-ref">Data analysis</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/case-study">Exercise</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/netcdf">Averaging Rainfall</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/range-modeling">Range Modeling</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Cartography-ref">Cartography</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Cartography/fundamentals">Fundamentals</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Cartography/cartography">Cartography</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Cartography/map-types">Map Types</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Distribution-ref">Distribution</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Distribution/distribution">Distribution</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Distribution/web-mapping">Web Mapping</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Things to Come-ref">Things to come</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Things to Come/future">Future</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="Applications-ref">Applications</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/Applications/qgis">QGIS</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Applications/grass-gis">GRASS GIS</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Applications/panoply">Panoply</a></li>
      	
      
    
  




                  </ul>
                 
                  <h4 id="References-ref">References</h4>
                  <!-- add class="divider" to li in page list-->
                  <ul>
                      
                    




  
    
      
      	
      	<li><a href="/bootcamp/References/citations">Citations</a></li>
      	
      
    
  
    
      
      	
      	<li class="active"><a href="/bootcamp/References/scripts" class="active">Scripts</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/References/tools">Tools</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/References/case-study">Landslide Susceptibility</a></li>
      	
      
    
  




                  </ul>
                
                  </ul>
                </li>

              </ul>

            </div><!-- dropdown nav -->
<article class="unit-article layout-post">
	<div class="unit-inner unit-article-inner">
		<div class="content">
			<header id="content-header">
				<div class="unit-head">
					<div class="unit-inner unit-head-inner">
            <h1 class="h2 entry-title">Scripts</h1> 
            <!--            <h2 class="h2 entry-title"></h2> -->



					</div><!-- unit-inner -->
				</div><!-- unit-head -->
			</header>

    
      <!--
      <div class="col-md-2 sticky-left-nav">
 
  <h4 id="Setup-ref">Setup</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Setup/qgis-install">Installing QGIS</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Intro-ref">Intro</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Intro/what">Is Spatial Special?</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Intro/intro">Vectors and Rasters</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Intro/projections">Projections</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Data Collection-ref">Data collection</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/metadata">Metadata</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/consumable-services">Consumable Services</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/credible-sources">Credible Data Sources</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Data Wrangling-ref">Data wrangling</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Data Wrangling/functions">Spatial Manipulation</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Data wrangling-ref">Data wrangling</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Data wrangling/data-wrangling">Data Formatting</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Data Analysis-ref">Data analysis</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/case-study">Exercise</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/netcdf">Averaging Rainfall</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/range-modeling">Range Modeling</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Cartography-ref">Cartography</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Cartography/fundamentals">Fundamentals</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Cartography/cartography">Cartography</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Cartography/map-types">Map Types</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Distribution-ref">Distribution</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Distribution/distribution">Distribution</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Distribution/web-mapping">Web Mapping</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Things to Come-ref">Things to come</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Things to Come/future">Future</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Applications-ref">Applications</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Applications/qgis">QGIS</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Applications/grass-gis">GRASS GIS</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Applications/panoply">Panoply</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="References-ref">References</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/References/citations">Citations</a></li>
      	
      
    
  
    
      
      	
      	<li class="active"><a href="/bootcamp/References/scripts" class="active">Scripts</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/References/tools">Tools</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/References/case-study">Landslide Susceptibility</a></li>
      	
      
    
  




  </ul>


    </div>
    -->
			<div class="bd">

        <!-- sticky left navigation -->
<div id="sticky-anchor" class="sticky-left-nav">
  <div id="sticky" class="sticky-left-nav-inner">
    <h3>Contents</h3>
    
   
  <h4 id="Setup-ref">Setup</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Setup/qgis-install">Installing QGIS</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Intro-ref">Intro</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Intro/what">Is Spatial Special?</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Intro/intro">Vectors and Rasters</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Intro/projections">Projections</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Data Collection-ref">Data collection</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/metadata">Metadata</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/consumable-services">Consumable Services</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Collection/credible-sources">Credible Data Sources</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Data Wrangling-ref">Data wrangling</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Data Wrangling/functions">Spatial Manipulation</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Data wrangling-ref">Data wrangling</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Data wrangling/data-wrangling">Data Formatting</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Data Analysis-ref">Data analysis</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/case-study">Exercise</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/netcdf">Averaging Rainfall</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Data Analysis/range-modeling">Range Modeling</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Cartography-ref">Cartography</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Cartography/fundamentals">Fundamentals</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Cartography/cartography">Cartography</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Cartography/map-types">Map Types</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Distribution-ref">Distribution</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Distribution/distribution">Distribution</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Distribution/web-mapping">Web Mapping</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Things to Come-ref">Things to come</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Things to Come/future">Future</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="Applications-ref">Applications</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/Applications/qgis">QGIS</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Applications/grass-gis">GRASS GIS</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/Applications/panoply">Panoply</a></li>
      	
      
    
  




  </ul>
 
  <h4 id="References-ref">References</h4>
  <ul>
      
    




  
    
      
      	
      	<li><a href="/bootcamp/References/citations">Citations</a></li>
      	
      
    
  
    
      
      	
      	<li class="active"><a href="/bootcamp/References/scripts" class="active">Scripts</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/References/tools">Tools</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/bootcamp/References/case-study">Landslide Susceptibility</a></li>
      	
      
    
  




  </ul>

  </div>  
  <div class="clear"></div>
</div> <!--left-nav -->



<div class="entry-content content">
  <h1 id="script-reference">Script Reference</h1>

<h3 id="bash-script-to-subset-and-ensemble-annual-average-precipitation-data-from-daily-accumulation">Bash script to subset, and ensemble annual average precipitation data from daily accumulation.</h3>

<h4 id="climatologysh"><em>climatology.sh</em></h4>

<div>
  <pre><code class="bash">#!/bin/bash
#***************************************************
#     CALC YEARLY ANNUAL AVERAGES FROM DAILY DATA
#***************************************************

#** Check that there was an output directory supplied
if [[ $# -eq 0 ]] ; 
then
  echo 'Usage: ./climatology.sh output_directory'
  exit 1
fi


OUTDIR=$1


if [ -d $OUTDIR ] ;
then 
  echo &quot;Creating folder for temporary files&quot;
  TMPDIR=${OUTDIR}/tmp
  if [ ! -d $TMPDIR ] ;
  then
    mkdir ${TMPDIR}
  fi
fi
#Clear log file 
&gt; log.txt

URL=&quot;http://www.esrl.noaa.gov/psd/thredds/dodsC/Datasets/cpc_us_precip/RT/precip.V1.0&quot;

function createPrecip() {
for year in {2007..2014}
do
  echo $year
  #Clip the input to (-125.4,44.0),(-115.0,50.0)
  tmpSubset=${TMPDIR}/subset.${year}.nc
  echo &quot;Subsetting precipitation data to study area to ${tmpSubset}&quot;
  ncks -O -d lon,234.0,244.0 -d lat,44.0,50.0 ${URL}.${year}.nc ${tmpSubset}
  echo &quot;&quot; 
  echo &quot;Finished subsetting the data, setting min/max and null values&quot;
  echo &quot;&quot;
  echo `ncdump -h -v precip ${tmpSubset}`
  
  echo &quot;&quot;
  echo &quot;Finished subsetting ${tmpSubset}, removing Null values...&quot;
  tmpNaRm=${TMPDIR}/narm.${year}.nc
  ncap2 -O -s 'where(precip &lt; 0.0 || precip &gt; 10000 ) precip=0;' ${tmpSubset} ${tmpNaRm}


  echo &quot;&quot;
  echo &quot;Finished subsetting ${tmpNaRm}, summarizing the daily precipitation data...&quot;
  echo &quot;&quot;
  #Summarize the daily precipitation data for the last 7 years
  tmpAnnual=${TMPDIR}/annual.${year}.nc
  ncra -O --op_typ=ttl -d time,,,1 -v precip ${tmpNaRm} ${tmpAnnual}

  echo &quot;&quot;
  echo &quot;Regridding ${tmpAnnual} to 1km resolution&quot;
  echo &quot;&quot;
  #Regrid the annual data to 1km
  tmpRegrid=${TMPDIR}/regrid.${year}.nc
  export FILE=${tmpAnnual}
  export  OUTFILE=&quot;${tmpRegrid}&quot;
  export OUTDIR=&quot;${TMPDIR}&quot;
  ncl regrid.ncl
  echo &quot;&quot;
  echo &quot;Finished regridding ${tmpRegrid}&quot;
  echo &quot;&quot;
done
avgAnnual=${TMPDIR}/avg_annual.nc
echo &quot;Averaging annuals precipitation to ${avgAnnual}&quot;
nces -O -n 8,2,1 ${TMPDIR}/regrid.2007.nc $avgAnnual


}

createPrecip &gt; log.txt</code></pre>
</div>

<h3 id="script-to-convert-netcdf-to-a-projected-geotiff">Script to convert netCDF to a projected GeoTiff</h3>

<h4 id="ncf2gtfr"><em>ncf2gtf.r</em></h4>

<div>
  <pre><code class="R">################################################
##     This R script will take open a 
##     netcdf-4 file and output it to a geotiff
##     
#################################################

library(raster)
library(ncdf4)
library(rgdal)

setwd('/home/ncasler/bootcamp/nco/tmp')


r &lt;- raster('avg_annual.nc')

oldExt &lt;- extent(r)


#Subtract 360 from the x coordinates
# will make coordinates lat/lon friendly
xMin &lt;- oldExt[1] - 360
xMax &lt;- oldExt[2] - 360
yMin &lt;- oldExt[3]
yMax &lt;- oldExt[4]

geoExt &lt;- extent(xMin, xMax, yMin, yMax)
r &lt;- setExtent(r, geoExt, keepres=TRUE)
newProj &lt;- '+proj=lcc +lat_1=47.33333333333334 +lat_2=45.83333333333334 +lat_0=45.33333333333334 +lon_0=-120.5 +x_0=500000.0001016001 +y_0=0 +ellps=GRS80 +to_meter=0.3048006096012192 +no_defs' 
xMinPrj &lt;- 548554.658
xMaxPrj &lt;- 2558498.351
yMinPrj &lt;- 77271.774
yMaxPrj &lt;- 1366159.434

xRes &lt;- 1000
yRes &lt;- 1000

newRaster &lt;- raster(xmn=xMinPrj, xmx=xMaxPrj, ymn=yMinPrj, ymx=yMaxPrj, crs=newProj, res=1000)

newR &lt;- projectRaster(r, newRaster)

print(&quot;Finished projecting raster&quot;)

summary(newR)
fileout &lt;- &quot;testRout.tif&quot;
print(paste0(&quot;Writing new Raster to &quot;, fileout))

writeRaster(newR, filename=fileout, format=&quot;GTiff&quot;, options=c(&quot;COMPRESS=ZIP&quot;), overwrite=TRUE)

print(&quot;Finished outputting raster. Exiting...&quot;)</code></pre>
</div>

<h3 id="netcdf-regridding-script-written-in-ncar-command-language">NetCDF Regridding Script written in NCAR Command Language</h3>

<h4 id="regridncl"><em>regrid.ncl</em></h4>

<div>
  <pre><code class="R">;***********************************************
; This script will read in netcdf precipitation files
;***********************************************
; Load the necessary scripts
;***********************************************
load &quot;$NCARG_NCARG/nclscripts/csm/gsn_code.ncl&quot;
load &quot;$NCARG_NCARG/nclscripts/csm/gsn_csm.ncl&quot;
load &quot;$NCARG_NCARG/nclscripts/csm/contributed.ncl&quot;
load &quot;$NCARG_NCARG/nclscripts/csm/shea_util.ncl&quot;
;***********************************************
begin
;***********************************************
; Read in the netCDF file

  

  fn = getenv(&quot;FILE&quot;)
  print(&quot;Input file is &quot; + fn)
  fileout = getenv(&quot;OUTFILE&quot;)
  print(&quot;Output file is &quot; + fileout)


  fi = addfile(fn, &quot;r&quot;)

  setfileoption(&quot;nc&quot;, &quot;Format&quot;, &quot;NetCDF4Classic&quot;)

;***********************************************
; Read in original dimensions
;***********************************************
  time = fi-&gt;time
;   Remove the time dimension from the precip variable(dimension order is time,lon,lat)
  precip = fi-&gt;precip(0,:,:)
  print(&quot;Precip max = &quot;+ max(precip))
  print(&quot;Precip min = &quot;+ min(precip))
 
 ; Read in the latitude and longitude dimensions
  lat = fi-&gt;lat
  lon = fi-&gt;lon
  printVarSummary(precip)
  
;**********************************************
; Create new dimension definitions
;**********************************************
;Set new extent
;*********************************************

  newXMin = 360 - 125.0463254981687271
  newYMin = 45.4641026583566514
  newXMax = 360 -  116.6757915137716282
  newYMax = 49.0780358101814755
;**********************************************
; Create new dimensions
;**********************************************
  newlat = fspan(newYMin,newYMax,1312)
  newlon = fspan(newXMin,newXMax,2088)
  newlat@units = &quot;degrees_north&quot;
  newlat@long_name = &quot;Latitude&quot;
  newlat@actual_range = (/newXMin, newXMax/)
  newlat@standard_name = &quot;latitude&quot;
  newlat@axis = &quot;Y&quot;

  newlon@units = &quot;degrees_east&quot;
  newlon@long_name = &quot;Longitude&quot;
  newlon@actual_range = (/newYMin, newYMax/)
  newlon@standard_name = &quot;longitude&quot;
  newlon@axis = &quot;X&quot;


  newprecip = linint2(fi&amp;lon,fi&amp;lat,precip,False,newlon,newlat,0)
;****************************************************
; Change all missing values to 0
;****************************************************
  printVarSummary(newprecip)
  print(&quot;NewPrecip Max: &quot;+max(newprecip))
  print(&quot;NewPrecip Min: &quot;+min(newprecip))
  newprecip!0 = &quot;lat&quot;
  newprecip!1 = &quot;lon&quot;
  newprecip&amp;lat = newlat
  newprecip&amp;lon = newlon
  newprecip@valid_range = (/min(newprecip), max(newprecip)/)
  newprecip@long_name = &quot;Average Annual Precipitation 2007-2014&quot;
  newprecip@units = &quot;mm&quot;
  newprecip@var_desc = &quot;Precipitation&quot;
  newprecip@level_desc = &quot;Surface&quot;
  newprecip@statistic = &quot;Average Annual Accumulation&quot;

;*************************************************
; Settings for output file
;************************************************

  nlat = dimsizes(newlat)           ; get dimension sizes
  nlon = dimsizes(newlon)
  
  print(&quot;File out is: &quot;+fileout)
  system(&quot;/bin/rm -f &quot; + fileout) ; remove if exists
  fout = addfile(fileout, &quot;c&quot;)   ; open output file
;************************************************
; explicitly declare file definition mode. Improve efficiency
;************************************************
  setfileoption(fout,&quot;DefineMode&quot;,True)

;************************************************
; create global attributes of the output file
;************************************************
  fAtt                = True        ;assign file attributes
  fAtt@title          = &quot;Interpolated Annual Precipitation&quot;
  fAtt@source_file    = fn
  fAtt@Conventions    = &quot;COARDS&quot;
  fAtt@description    = &quot;Interpolated annual Precipitation&quot;
  fAtt@creation_date  = systemfunc  (&quot;date&quot;)
  fileattdef( fout, fAtt )          ; copy file attributes

;*************************************************
; predefine the coordinate variables and their dimensionality
; Note: to get an UNLIMITED record dimension, we set the dimensionality
; to -1 (or the actual size) and set the dimension name to True.
;*************************************************
  dimNames  = (/&quot;lat&quot;, &quot;lon&quot;/)
  dimSizes  = (/ nlat, nlon/)
  dimUnlim  = (/ False, False/)
  filedimdef(fout,dimNames,dimSizes,dimUnlim)

;*************************************************
; Predefine the dimensionality of the variables to be written out
;*************************************************
; Here we are using NCL functions to facilitate defining
; each variable's dimension name(s) and type.
; The following could be replaced with explicit, user-defined dimension
; names different from those associated with the variable in memory
; Say, PS(time,lat,lon) in the NCL script. They could be redefined for the file via: 
; filevardef(fout, &quot;PS&quot;, typeof(PS), (/&quot;TIME&quot;, &quot;latitude&quot;, &quot;longitude&quot;/))
;*************************************************

  filevardef(fout, &quot;lat&quot;, typeof(lat), getvardims(lat))
  filevardef(fout, &quot;lon&quot;, typeof(lon), getvardims(lon))
  filevardef(fout, &quot;precip&quot;, typeof(newprecip), getvardims(newprecip))

;*************************************************
; Copy attributes associated with each variable to the file
; All attributes associated with each variable will be copied.
;*************************************************
  filevarattdef(fout,&quot;precip&quot;,newprecip)      ; copy newprecip attributes
  filevarattdef(fout,&quot;lat&quot;, newlat)           ; copy lat attributes
  filevarattdef(fout,&quot;lon&quot;, newlon)           ; copy lon attributes

;*************************************************
; explicitly exit file definition mode. **NOT REQUIRED**
;*************************************************
  setfileoption(fout,&quot;DefineMode&quot;, False)

;*************************************************
; output only the data values since the dimensionality and such have
; been predefined. The &quot;(/&quot;,&quot;/)&quot; syntax tells NCL to only output the
; data values to the predefined locations on the file
;**************************************************
  fout-&gt;lat     = (/newlat/)
  fout-&gt;lon     = (/newlon/)
  fout-&gt;precip  = (/newprecip/)
  print(fout)
end</code></pre>
</div>



          <!--
					<div class="meta">
						<p class="date-publish">
							Published: 
							<date class="date-pub" title="2009-12-29T00:00:00-07:00" datetime="2009-12-29T00:00:00-07:00" pubdate>
							<span class="month"><abbr>December</abbr></span>
							<span class="day">29</span>
							<span class="year">2009</span>
							</date>
						</p>
						<ul class="list-category list-linear">
							<li class="list-head">category: </li>
							
							


  
     
    	<li><a href="/categories.html#References-ref">
    		References <span>4</span>
    	</a></li>
    
  


						</ul>
						<ul class="list-tag list-linear">
							<li class="list-head">tags: </li>
							
							


  
     
    	<li><a href="/tags.html#R-ref">R <span>2</span></a></li>
     
    	<li><a href="/tags.html#Bash-ref">Bash <span>1</span></a></li>
     
    	<li><a href="/tags.html#NCL-ref">NCL <span>1</span></a></li>
     
    	<li><a href="/tags.html#scripting-ref">scripting <span>1</span></a></li>
    
  



						</ul>
					</div>
          meta -->


				</div><!-- entry-content -->
				<div class="misc-content">
					<div class="social">
						<ul class="list-linear">
							<li><div class="twitter-tweet"><a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal" data-via="" data-lang="en">Tweet</a></div></li>
							<li><div class="twitter-follow"><a href="https://twitter.com/" class="twitter-follow-button" data-show-count="false" data-lang="en"></a></div></li>
						</ul>
					</div>
					
					
				</div><!-- misc-content -->
				
			</div><!-- bd -->
			<footer class="unit-foot">
				<div class="unit-inner unit-foot-inner">
					<nav class="pagination">
						<ul>
							
              <li class="prev"><a class="internal" rel="prev"  href="/bootcamp/References/tools" title="View Tools">&laquo; Tools</a></li>
							
							
							<li class="pipe"> | </li>
							
							
              <li class="next"><a class="internal" rel="next"  href="/bootcamp/References/citations" title="View Citations">Citations &raquo;</a></li>
							
						</ul>
					</nav>
					<p class="gotop">
						<a href="#page">Back to Top</a>
					</p>
				</div>
			</footer>

		</div><!-- content -->
	</div><!-- unit-inner -->
</article>


				</div>
			</div><!-- unit-inner -->
		</div><!-- unit-body -->
	</div><!-- body -->
	<footer class="the-footer">
		<div class="unit-foot">
			<div class="unit-inner unit-foot-inner">
				<div class="misc vcard">
					<h4>about</h4>
					<ul>
						<li class="contact"><address><span class="author fn n">Nathan Casler</span> - <span class="fn email">ncasler@email.arizona.edu</span></address></li>
            <!--						<li class="github"><a href="http://github.com//" rel="me">github.com/</a></li>
						<li class="twitter"><a href="http://twitter.com//" rel="me">twitter.com/</a></li>
            <li class="rss"><a href="http://feeds.feedburner.com/">Subscribe to RSS Feed</a></li>-->
					</ul>
				</div><!-- misc -->
				<p class="licence">
        <!--					Theme: <a href="http://layouts-the.me">the_minimum</a> based on <a href="http://jekyllbootstrap.com/">Jekyll-bootstrap</a>.<br>-->
					Powered by <a href="https://github.com/mojombo/jekyll">Jekyll</a>.
				</p>
			</div><!-- unit-foot-inner -->
		</div><!-- unit-foot -->
	</footer>
</div><!-- page -->
</div><!-- page-container -->
<script>
	(function(d, s) {
		var js, fjs = d.getElementsByTagName(s)[0], load = function(url, id) {
		if (d.getElementById(id)) {return;}
		js = d.createElement(s); js.src = url; js.id = id;
		fjs.parentNode.insertBefore(js, fjs);
		};
	load('//platform.twitter.com/widgets.js', 'tweetjs');
	// load('https://apis.google.com/js/plusone.js', 'gplus1js'); // Checkout http://j.mp/ApDgMr for usage html for this is <div class="g-plusone" data-size="medium"></div>
	// load('//connect.facebook.net/en_US/all.js#xfbml=1', 'fbjssdk'); // Checkout http://j.mp/wZw2xR for using open graph protorol html for this is <div class="fb-like" data-href="/References/scripts" data-send="false" data-layout="button_count" data-width="450" data-show-faces="false" data-font="verdana"></div>
	}(document, 'script'));
</script>
<script>
/*! A fix for the iOS orientationchange zoom bug.Script by @scottjehl, rebound by @wilto. MIT License.*/
(function(j){var i=j.document;if(!i.querySelectorAll){return}var l=i.querySelectorAll("meta[name=viewport]")[0],a=l&&l.getAttribute("content"),h=a+", maximum-scale=1.0",d=a+", maximum-scale=10.0",g=true,c=j.orientation,k=0;if(!l){return}function f(){l.setAttribute("content",d);g=true}function b(){l.setAttribute("content",h);g=false}function e(m){c=Math.abs(j.orientation);k=Math.abs(m.gamma);if(k>8&&c===0){if(g){b()}}else{if(!g){f()}}}j.addEventListener("orientationchange",f,false);j.addEventListener("deviceorientation",e,false)})(this);
</script>

  
</body>
</html>

